{"ast":null,"code":"/**\n * Copyright (c) 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule DraftEditorDragHandler\n * @format\n * \n */\n\n'use strict';\n\nvar DataTransfer = require('fbjs/lib/DataTransfer');\nvar DraftModifier = require('./DraftModifier');\nvar EditorState = require('./EditorState');\nvar findAncestorOffsetKey = require('./findAncestorOffsetKey');\nvar getTextContentFromFiles = require('./getTextContentFromFiles');\nvar getUpdatedSelectionState = require('./getUpdatedSelectionState');\nvar isEventHandled = require('./isEventHandled');\nvar nullthrows = require('fbjs/lib/nullthrows');\n\n/**\n * Get a SelectionState for the supplied mouse event.\n */\nfunction getSelectionForEvent(event, editorState) {\n  var node = null;\n  var offset = null;\n  if (typeof document.caretRangeFromPoint === 'function') {\n    var dropRange = document.caretRangeFromPoint(event.x, event.y);\n    node = dropRange.startContainer;\n    offset = dropRange.startOffset;\n  } else if (event.rangeParent) {\n    node = event.rangeParent;\n    offset = event.rangeOffset;\n  } else {\n    return null;\n  }\n  node = nullthrows(node);\n  offset = nullthrows(offset);\n  var offsetKey = nullthrows(findAncestorOffsetKey(node));\n  return getUpdatedSelectionState(editorState, offsetKey, offset, offsetKey, offset);\n}\nvar DraftEditorDragHandler = {\n  /**\n   * Drag originating from input terminated.\n   */\n  onDragEnd: function onDragEnd(editor) {\n    editor.exitCurrentMode();\n  },\n  /**\n   * Handle data being dropped.\n   */\n  onDrop: function onDrop(editor, e) {\n    var data = new DataTransfer(e.nativeEvent.dataTransfer);\n    var editorState = editor._latestEditorState;\n    var dropSelection = getSelectionForEvent(e.nativeEvent, editorState);\n    e.preventDefault();\n    editor.exitCurrentMode();\n    if (dropSelection == null) {\n      return;\n    }\n    var files = data.getFiles();\n    if (files.length > 0) {\n      if (editor.props.handleDroppedFiles && isEventHandled(editor.props.handleDroppedFiles(dropSelection, files))) {\n        return;\n      }\n      getTextContentFromFiles(files, function (fileText) {\n        fileText && editor.update(insertTextAtSelection(editorState, dropSelection, fileText));\n      });\n      return;\n    }\n    var dragType = editor._internalDrag ? 'internal' : 'external';\n    if (editor.props.handleDrop && isEventHandled(editor.props.handleDrop(dropSelection, data, dragType))) {\n      return;\n    }\n    if (editor._internalDrag) {\n      editor.update(moveText(editorState, dropSelection));\n      return;\n    }\n    editor.update(insertTextAtSelection(editorState, dropSelection, data.getText()));\n  }\n};\nfunction moveText(editorState, targetSelection) {\n  var newContentState = DraftModifier.moveText(editorState.getCurrentContent(), editorState.getSelection(), targetSelection);\n  return EditorState.push(editorState, newContentState, 'insert-fragment');\n}\n\n/**\n * Insert text at a specified selection.\n */\nfunction insertTextAtSelection(editorState, selection, text) {\n  var newContentState = DraftModifier.insertText(editorState.getCurrentContent(), selection, text, editorState.getCurrentInlineStyle());\n  return EditorState.push(editorState, newContentState, 'insert-fragment');\n}\nmodule.exports = DraftEditorDragHandler;","map":{"version":3,"names":["DataTransfer","require","DraftModifier","EditorState","findAncestorOffsetKey","getTextContentFromFiles","getUpdatedSelectionState","isEventHandled","nullthrows","getSelectionForEvent","event","editorState","node","offset","document","caretRangeFromPoint","dropRange","x","y","startContainer","startOffset","rangeParent","rangeOffset","offsetKey","DraftEditorDragHandler","onDragEnd","editor","exitCurrentMode","onDrop","e","data","nativeEvent","dataTransfer","_latestEditorState","dropSelection","preventDefault","files","getFiles","length","props","handleDroppedFiles","fileText","update","insertTextAtSelection","dragType","_internalDrag","handleDrop","moveText","getText","targetSelection","newContentState","getCurrentContent","getSelection","push","selection","text","insertText","getCurrentInlineStyle","module","exports"],"sources":["/Users/zhangqiang/Documents/GitHub/frontEnd-all-knowledge/examples/react/a08antd带编辑的表格/node_modules/rc-editor-mention/node_modules/draft-js/lib/DraftEditorDragHandler.js"],"sourcesContent":["/**\n * Copyright (c) 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule DraftEditorDragHandler\n * @format\n * \n */\n\n'use strict';\n\nvar DataTransfer = require('fbjs/lib/DataTransfer');\nvar DraftModifier = require('./DraftModifier');\nvar EditorState = require('./EditorState');\n\nvar findAncestorOffsetKey = require('./findAncestorOffsetKey');\nvar getTextContentFromFiles = require('./getTextContentFromFiles');\nvar getUpdatedSelectionState = require('./getUpdatedSelectionState');\nvar isEventHandled = require('./isEventHandled');\nvar nullthrows = require('fbjs/lib/nullthrows');\n\n/**\n * Get a SelectionState for the supplied mouse event.\n */\nfunction getSelectionForEvent(event, editorState) {\n  var node = null;\n  var offset = null;\n\n  if (typeof document.caretRangeFromPoint === 'function') {\n    var dropRange = document.caretRangeFromPoint(event.x, event.y);\n    node = dropRange.startContainer;\n    offset = dropRange.startOffset;\n  } else if (event.rangeParent) {\n    node = event.rangeParent;\n    offset = event.rangeOffset;\n  } else {\n    return null;\n  }\n\n  node = nullthrows(node);\n  offset = nullthrows(offset);\n  var offsetKey = nullthrows(findAncestorOffsetKey(node));\n\n  return getUpdatedSelectionState(editorState, offsetKey, offset, offsetKey, offset);\n}\n\nvar DraftEditorDragHandler = {\n  /**\n   * Drag originating from input terminated.\n   */\n  onDragEnd: function onDragEnd(editor) {\n    editor.exitCurrentMode();\n  },\n\n  /**\n   * Handle data being dropped.\n   */\n  onDrop: function onDrop(editor, e) {\n    var data = new DataTransfer(e.nativeEvent.dataTransfer);\n\n    var editorState = editor._latestEditorState;\n    var dropSelection = getSelectionForEvent(e.nativeEvent, editorState);\n\n    e.preventDefault();\n    editor.exitCurrentMode();\n\n    if (dropSelection == null) {\n      return;\n    }\n\n    var files = data.getFiles();\n    if (files.length > 0) {\n      if (editor.props.handleDroppedFiles && isEventHandled(editor.props.handleDroppedFiles(dropSelection, files))) {\n        return;\n      }\n\n      getTextContentFromFiles(files, function (fileText) {\n        fileText && editor.update(insertTextAtSelection(editorState, dropSelection, fileText));\n      });\n      return;\n    }\n\n    var dragType = editor._internalDrag ? 'internal' : 'external';\n    if (editor.props.handleDrop && isEventHandled(editor.props.handleDrop(dropSelection, data, dragType))) {\n      return;\n    }\n\n    if (editor._internalDrag) {\n      editor.update(moveText(editorState, dropSelection));\n      return;\n    }\n\n    editor.update(insertTextAtSelection(editorState, dropSelection, data.getText()));\n  }\n};\n\nfunction moveText(editorState, targetSelection) {\n  var newContentState = DraftModifier.moveText(editorState.getCurrentContent(), editorState.getSelection(), targetSelection);\n  return EditorState.push(editorState, newContentState, 'insert-fragment');\n}\n\n/**\n * Insert text at a specified selection.\n */\nfunction insertTextAtSelection(editorState, selection, text) {\n  var newContentState = DraftModifier.insertText(editorState.getCurrentContent(), selection, text, editorState.getCurrentInlineStyle());\n  return EditorState.push(editorState, newContentState, 'insert-fragment');\n}\n\nmodule.exports = DraftEditorDragHandler;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}