{"ast":null,"code":"/**\n * Copyright (c) 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule getUpdatedSelectionState\n * @format\n * \n */\n\n'use strict';\n\nvar DraftOffsetKey = require('./DraftOffsetKey');\nvar nullthrows = require('fbjs/lib/nullthrows');\nfunction getUpdatedSelectionState(editorState, anchorKey, anchorOffset, focusKey, focusOffset) {\n  var selection = nullthrows(editorState.getSelection());\n  if (process.env.NODE_ENV !== 'production') {\n    if (!anchorKey || !focusKey) {\n      /*eslint-disable no-console */\n      console.warn('Invalid selection state.', arguments, editorState.toJS());\n      /*eslint-enable no-console */\n      return selection;\n    }\n  }\n  var anchorPath = DraftOffsetKey.decode(anchorKey);\n  var anchorBlockKey = anchorPath.blockKey;\n  var anchorLeaf = editorState.getBlockTree(anchorBlockKey).getIn([anchorPath.decoratorKey, 'leaves', anchorPath.leafKey]);\n  var focusPath = DraftOffsetKey.decode(focusKey);\n  var focusBlockKey = focusPath.blockKey;\n  var focusLeaf = editorState.getBlockTree(focusBlockKey).getIn([focusPath.decoratorKey, 'leaves', focusPath.leafKey]);\n  var anchorLeafStart = anchorLeaf.get('start');\n  var focusLeafStart = focusLeaf.get('start');\n  var anchorBlockOffset = anchorLeaf ? anchorLeafStart + anchorOffset : null;\n  var focusBlockOffset = focusLeaf ? focusLeafStart + focusOffset : null;\n  var areEqual = selection.getAnchorKey() === anchorBlockKey && selection.getAnchorOffset() === anchorBlockOffset && selection.getFocusKey() === focusBlockKey && selection.getFocusOffset() === focusBlockOffset;\n  if (areEqual) {\n    return selection;\n  }\n  var isBackward = false;\n  if (anchorBlockKey === focusBlockKey) {\n    var anchorLeafEnd = anchorLeaf.get('end');\n    var focusLeafEnd = focusLeaf.get('end');\n    if (focusLeafStart === anchorLeafStart && focusLeafEnd === anchorLeafEnd) {\n      isBackward = focusOffset < anchorOffset;\n    } else {\n      isBackward = focusLeafStart < anchorLeafStart;\n    }\n  } else {\n    var startKey = editorState.getCurrentContent().getBlockMap().keySeq().skipUntil(function (v) {\n      return v === anchorBlockKey || v === focusBlockKey;\n    }).first();\n    isBackward = startKey === focusBlockKey;\n  }\n  return selection.merge({\n    anchorKey: anchorBlockKey,\n    anchorOffset: anchorBlockOffset,\n    focusKey: focusBlockKey,\n    focusOffset: focusBlockOffset,\n    isBackward: isBackward\n  });\n}\nmodule.exports = getUpdatedSelectionState;","map":{"version":3,"names":["DraftOffsetKey","require","nullthrows","getUpdatedSelectionState","editorState","anchorKey","anchorOffset","focusKey","focusOffset","selection","getSelection","process","env","NODE_ENV","console","warn","arguments","toJS","anchorPath","decode","anchorBlockKey","blockKey","anchorLeaf","getBlockTree","getIn","decoratorKey","leafKey","focusPath","focusBlockKey","focusLeaf","anchorLeafStart","get","focusLeafStart","anchorBlockOffset","focusBlockOffset","areEqual","getAnchorKey","getAnchorOffset","getFocusKey","getFocusOffset","isBackward","anchorLeafEnd","focusLeafEnd","startKey","getCurrentContent","getBlockMap","keySeq","skipUntil","v","first","merge","module","exports"],"sources":["/Users/zhangqiang/Documents/GitHub/frontEnd-all-knowledge/examples/react/a08antd带编辑的表格/node_modules/rc-editor-mention/node_modules/draft-js/lib/getUpdatedSelectionState.js"],"sourcesContent":["/**\n * Copyright (c) 2013-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @providesModule getUpdatedSelectionState\n * @format\n * \n */\n\n'use strict';\n\nvar DraftOffsetKey = require('./DraftOffsetKey');\n\nvar nullthrows = require('fbjs/lib/nullthrows');\n\nfunction getUpdatedSelectionState(editorState, anchorKey, anchorOffset, focusKey, focusOffset) {\n  var selection = nullthrows(editorState.getSelection());\n  if (process.env.NODE_ENV !== 'production') {\n    if (!anchorKey || !focusKey) {\n      /*eslint-disable no-console */\n      console.warn('Invalid selection state.', arguments, editorState.toJS());\n      /*eslint-enable no-console */\n      return selection;\n    }\n  }\n\n  var anchorPath = DraftOffsetKey.decode(anchorKey);\n  var anchorBlockKey = anchorPath.blockKey;\n  var anchorLeaf = editorState.getBlockTree(anchorBlockKey).getIn([anchorPath.decoratorKey, 'leaves', anchorPath.leafKey]);\n\n  var focusPath = DraftOffsetKey.decode(focusKey);\n  var focusBlockKey = focusPath.blockKey;\n  var focusLeaf = editorState.getBlockTree(focusBlockKey).getIn([focusPath.decoratorKey, 'leaves', focusPath.leafKey]);\n\n  var anchorLeafStart = anchorLeaf.get('start');\n  var focusLeafStart = focusLeaf.get('start');\n\n  var anchorBlockOffset = anchorLeaf ? anchorLeafStart + anchorOffset : null;\n  var focusBlockOffset = focusLeaf ? focusLeafStart + focusOffset : null;\n\n  var areEqual = selection.getAnchorKey() === anchorBlockKey && selection.getAnchorOffset() === anchorBlockOffset && selection.getFocusKey() === focusBlockKey && selection.getFocusOffset() === focusBlockOffset;\n\n  if (areEqual) {\n    return selection;\n  }\n\n  var isBackward = false;\n  if (anchorBlockKey === focusBlockKey) {\n    var anchorLeafEnd = anchorLeaf.get('end');\n    var focusLeafEnd = focusLeaf.get('end');\n    if (focusLeafStart === anchorLeafStart && focusLeafEnd === anchorLeafEnd) {\n      isBackward = focusOffset < anchorOffset;\n    } else {\n      isBackward = focusLeafStart < anchorLeafStart;\n    }\n  } else {\n    var startKey = editorState.getCurrentContent().getBlockMap().keySeq().skipUntil(function (v) {\n      return v === anchorBlockKey || v === focusBlockKey;\n    }).first();\n    isBackward = startKey === focusBlockKey;\n  }\n\n  return selection.merge({\n    anchorKey: anchorBlockKey,\n    anchorOffset: anchorBlockOffset,\n    focusKey: focusBlockKey,\n    focusOffset: focusBlockOffset,\n    isBackward: isBackward\n  });\n}\n\nmodule.exports = getUpdatedSelectionState;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}